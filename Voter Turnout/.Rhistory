library(googlesheets4)
?read_sheet
shiny::runApp('BestToRegister')
?arrange
runApp('BestToRegister')
?drop
runApp('BestToRegister')
runApp('VotersOnTheFence/Voters on the Fence.R')
runApp('VotersOnTheFence/Voters on the Fence.R')
runApp('VotersOnTheFence/Voters on the Fence.R')
runApp('GitHub/voters/Shiny Apps/GetDonations')
runApp('GitHub/voters/Shiny Apps/GetDonations')
shiny::runApp('GitHub/voters/Shiny Apps/GetDonations')
runApp('GitHub/voters/Shiny Apps/Voters on the Fence/Voters on the Fence.R')
?renderDT
?datatable
runApp('GitHub/voters/Shiny Apps/Voters on the Fence/Voters on the Fence.R')
mayors <- read_xlsx('Mayor.xlsx',sheet="Cities")  %>%
mutate(voteperc = VotesCast/(Total2020PopOrEst-`Student Pop`-Under18)*100,
color=ifelse(College=='BYU-Idaho','Yes','No'))
library(tidyverse)
library(readxl)
mayors <- read_xlsx('Mayor.xlsx',sheet="Cities")  %>%
mutate(voteperc = VotesCast/(Total2020PopOrEst-`Student Pop`-Under18)*100,
color=ifelse(College=='BYU-Idaho','Yes','No'))
setwd("C:/Users/spenc/OneDrive/Documents/GitHub/Scroll/Voter Turnout")
mayors <- read_xlsx('Mayor.xlsx',sheet="Cities")  %>%
mutate(voteperc = VotesCast/(Total2020PopOrEst-`Student Pop`-Under18)*100,
color=ifelse(College=='BYU-Idaho','Yes','No'))
ggplot(mayors,aes(y=reorder(City,voteperc,'desc'),x=voteperc,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Turnout of non-student voting-age population',
title='Even without the school, Rexburg turnout is low',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,40,10),labels=c('0%','10%','20%','30%','40%'))
mayors <- read_xlsx('Mayor.xlsx',sheet="Cities")  %>%
mutate(voteperc = VotesCast/(Total2020PopOrEst-`Student Pop`-Under18)*100,
color=ifelse(College=='BYU-Idaho','Yes','No'))
ggplot(mayors,aes(y=reorder(City,voteperc,'desc'),x=voteperc,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Turnout of non-student voting-age population',
title='Even without the school, Rexburg turnout is low',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,40,10),labels=c('0%','10%','20%','30%','40%'))
mayors <- read_xlsx('Mayor.xlsx',sheet="Cities")  %>%
mutate(voteperc = VotesCast/(Total2020PopOrEst-`Student Pop`-Under18)*100,
color=ifelse(College=='BYU-Idaho','Yes','No'))
View(mayors)
ggplot(mayors,aes(y=reorder(City,Pop2020/`Student Pop`,'desc'),x=Pop2020/`Student Pop`,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Turnout of non-student voting-age population',
title='Even without the school, Rexburg turnout is low',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,40,10),labels=c('0%','10%','20%','30%','40%'))
mayors <- read_xlsx('Mayor.xlsx',sheet="Cities")  %>%
mutate(voteperc = VotesCast/(Total2020PopOrEst-`Student Pop`-Under18)*100,
color=ifelse(College=='BYU-Idaho','Yes','No'))
mayors <- read_xlsx('Mayor.xlsx',sheet="Cities")  %>%
mutate(voteperc = VotesCast/(Pop2020-`Student Pop`-Under18)*100,
color=ifelse(College=='BYU-Idaho','Yes','No'))
ggplot(mayors,aes(y=reorder(City,Pop2020/`Student Pop`,'desc'),x=Pop2020/`Student Pop`,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Turnout of non-student voting-age population',
title='Even without the school, Rexburg turnout is low',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,40,10),labels=c('0%','10%','20%','30%','40%'))
ggplot(mayors,aes(y=reorder(City,Pop2020/`Student Pop`,'desc'),x=Pop2020/`Student Pop`,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Turnout of non-student voting-age population',
title='Even without the school, Rexburg turnout is low',
caption='From each city\'s most recent election') #+
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020,'desc'),x=`Student Pop`/Pop2020,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Turnout of non-student voting-age population',
title='Even without the school, Rexburg turnout is low',
caption='From each city\'s most recent election') #+
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020,'desc'),x=`Student Pop`/Pop2020,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high percentage of students',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,60,20),labels=c('0%','20%','40%','60%'))
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020,'desc'),x=`Student Pop`/Pop2020,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high percentage of students',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high percentage of student populations',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high population of students',
caption='Based on election year enrollment and 2020 census') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
# PERCENTAGE OF VOTER AGE THAT VOTED
ggplot(mayors,aes(y=reorder(City,voteperc,'desc'),x=voteperc,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Turnout of non-student voting-age population',
title='Even without the school, Rexburg turnout is low',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,40,10),labels=c('0%','10%','20%','30%','40%'))
mayors <- read_xlsx('Mayor.xlsx',sheet="Cities")  %>%
mutate(voteperc = VotesCast/(Pop2020-`Student Pop`-Under18)*100,
color=ifelse(College=='BYU-Idaho','Yes','No'))
# PERCENTAGE OF VOTER AGE THAT VOTED
ggplot(mayors,aes(y=reorder(City,voteperc,'desc'),x=voteperc,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Turnout of non-student voting-age population',
title='Even without the school, Rexburg turnout is low',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,40,10),labels=c('0%','10%','20%','30%','40%'))
# PERCENTAGE OF TOWN THATS STUDENT
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high population of students',
caption='Based on election year enrollment and 2020 census') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
# PERCENTAGE OF TOWN THATS STUDENT
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,
fill=color,label = `Student Pop`/Pop2020*100)) +
geom_col() +
geom_text() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high population of students',
caption='Based on election year enrollment and 2020 census') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
# PERCENTAGE OF TOWN THATS STUDENT
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,
fill=color,label = round(`Student Pop`/Pop2020*100,0))) +
geom_col() +
geom_text() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high population of students',
caption='Based on election year enrollment and 2020 census') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
# PERCENTAGE OF TOWN THATS STUDENT
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,
fill=color,label = round(`Student Pop`/Pop2020*100,0))) +
geom_col() +
geom_text(nudge_x=.1) +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high population of students',
caption='Based on election year enrollment and 2020 census') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
# PERCENTAGE OF TOWN THATS STUDENT
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,
fill=color,label = round(`Student Pop`/Pop2020*100,0))) +
geom_col() +
geom_text(nudge_x=.02) +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high population of students',
caption='Based on election year enrollment and 2020 census') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
# PERCENTAGE OF TOWN THATS STUDENT
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,
fill=color,label = paste(round(`Student Pop`/Pop2020*100,0),'%'))) +
geom_col() +
geom_text(nudge_x=.02) +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high population of students',
caption='Based on election year enrollment and 2020 census') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
# PERCENTAGE OF TOWN THATS STUDENT
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,
fill=color,label = paste0(round(`Student Pop`/Pop2020*100,0),'%'))) +
geom_col() +
geom_text(nudge_x=.03) +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Percentage of town that is student',
title='Towns with a high population of students',
caption='Based on election year enrollment and 2020 census') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
# PERCENTAGE OF TOWN THATS STUDENT
ggplot(mayors,aes(y=reorder(City,`Student Pop`/Pop2020),x=`Student Pop`/Pop2020,
fill=color,label = paste0(round(`Student Pop`/Pop2020*100,0),'%'))) +
geom_col() +
geom_text(nudge_x=.03) +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Student population as a percent of total population',
title='Towns with a high population of students',
caption='Based on election year enrollment and 2020 census') +
scale_x_continuous(breaks=seq(0,.6,.2),labels=c('0%','20%','40%','60%'))
stacked <- mayors %>%
drop(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`) %>%
pivot_longer(cols=c(City, Year, College))
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
pivot_longer(cols=c(City, Year, College))
?pivot_longer
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
pivot_longer(cols=c(Pop2020,`Student Pop`,Under18))
View(stacked)
ggplot(stacked,aes(x=value,y=City)) +
geom_col(position='stack')
ggplot(stacked,aes(x=value,y=City,fill=name)) +
geom_col(position='stack')
pivot_longer(cols=c(stuperc,youthperc,voteperc))
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(stuperc = `Student Pop`/Pop2020,
youthperc = Under18/Pop2020) %>%
pivot_longer(cols=c(stuperc,youthperc,voteperc))
ggplot(stacked,aes(x=value,y=City,fill=name)) +
geom_col(position='stack')
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(stuperc = `Student Pop`/Pop2020,
youthperc = Under18/Pop2020) %>%
pivot_longer(cols=c(stuperc,youthperc,voteperc/100))
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(stuperc = `Student Pop`/Pop2020,
youthperc = Under18/Pop2020,
voteperc = voterperc*100) %>%
pivot_longer(cols=c(stuperc,youthperc,voteperc))
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(stuperc = `Student Pop`/Pop2020,
youthperc = Under18/Pop2020,
voteperc = voteperc*100) %>%
pivot_longer(cols=c(stuperc,youthperc,voteperc))
ggplot(stacked,aes(x=value,y=City,fill=name)) +
geom_col(position='stack')
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(stuperc = `Student Pop`/Pop2020,
youthperc = Under18/Pop2020,
voteperc = voteperc/100) %>%
pivot_longer(cols=c(stuperc,youthperc,voteperc))
ggplot(stacked,aes(x=value,y=City,fill=name)) +
geom_col(position='stack')
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(stuperc = `Student Pop`/Pop2020,
youthperc = Under18/Pop2020,
adultperc = otherpeople/Pop2020,
voteperc = voteperc/100) %>%
pivot_longer(cols=c(stuperc,youthperc,voteperc,adultperc))
mayors <- read_xlsx('Mayor.xlsx',sheet="Cities")  %>%
mutate(voteperc = VotesCast/(Pop2020-`Student Pop`-Under18)*100,
color=ifelse(College=='BYU-Idaho','Yes','No'),
otherpeople = Pop2020-`Student Pop`-Under18)
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(stuperc = `Student Pop`/Pop2020,
youthperc = Under18/Pop2020,
adultperc = otherpeople/Pop2020,
voteperc = voteperc/100) %>%
pivot_longer(cols=c(stuperc,youthperc,voteperc,adultperc))
ggplot(stacked,aes(x=value,y=City,fill=name)) +
geom_col(position='stack')
stacked <- mayors %>%
select(!c(VotesCast,RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(stuperc = `Student Pop`/Pop2020,
youthperc = Under18/Pop2020,
adultperc = otherpeople/Pop2020,
voteperc = (Pop2020-`Student Pop`-Under18)/Pop2020) %>%
pivot_longer(cols=c(stuperc,youthperc,voteperc,adultperc))
ggplot(stacked,aes(x=value,y=City,fill=name)) +
geom_col(position='stack')
#STACKED VOTER VS NON
stacked2 <- mayors %>%
select(!c(RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(voteperc = (Pop2020-VotesCast)/Pop2020,
otherperc = 1-voteperc) %>%
pivot_longer(cols=c(voteperc,otherperc))
ggplot(stacked2,aes(x=value,y=City,fill=name)) +
geom_col(position='stack')
# PERCENTAGE OF VOTER AGE THAT VOTED
ggplot(mayors,aes(y=reorder(City,voteperc,'desc'),x=voteperc,fill=color)) +
geom_col() +
theme_minimal() +
scale_fill_manual(values=c('Yes'='#A13935','No'='grey'))+
theme(legend.position='none') +
labs(y='College Town',x='Turnout of non-student voting-age population',
title='Even without the school, Rexburg turnout is low',
caption='From each city\'s most recent election') +
scale_x_continuous(breaks=seq(0,40,10),labels=c('0%','10%','20%','30%','40%'))
#STACKED VOTER VS NON
stacked2 <- mayors %>%
select(!c(RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(voteperc = (Pop2020-VotesCast)/Pop2020,
studperc = `Student Pop`/Pop2020,
otherperc = 1-voteperc-studperc) %>%
pivot_longer(cols=c(voteperc,otherperc,studperc))
ggplot(stacked2,aes(x=value,y=City,fill=name)) +
geom_col(position='stack')
#STACKED VOTER VS NON
stacked2 <- mayors %>%
select(!c(RegVoterTurnout,`SP Source`,`Election Source`)) %>%
mutate(voteperc = (VotesCast)/Pop2020,
studperc = `Student Pop`/Pop2020,
otherperc = 1-voteperc-studperc) %>%
pivot_longer(cols=c(voteperc,otherperc,studperc))
ggplot(stacked2,aes(x=value,y=City,fill=name)) +
geom_col(position='stack')
ggplot(stacked2,aes(x=value,y=City,fill=name)) +
geom_col(position='stack') +
theme_minimal() +
annotate('text',x=0,y=9,label='Voters') +
annotate('text',x=0.4,y=9,label='Students') +
annotate('text',x=.8,y=9,label='Non-student non-voters') +
state <- read_xlsx('Mayor.xlsx',sheet='State')
ggplot(stacked2,aes(x=value,y=City,fill=name)) +
geom_col(position='stack') +
theme_minimal() +
annotate('text',x=0,y=9,label='Voters') +
annotate('text',x=0.4,y=9,label='Students') +
annotate('text',x=.8,y=9,label='Non-student non-voters')
